--------------------------------------------------------------------------------
-- <auto-generated>                                                           --
--     This code was generated by a tool.                                     --
--                                                                            --
--     Changes to this file may cause incorrect behavior and will be lost if  --
--     the code is regenerated.                                               --
-- </auto-generated>                                                          --
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--                                                                            --
--    Copyright(c) 2023 Alexander Gamper, All Rights Reserved.                --
--                                                                            --
--    Ada-WinRT                                                               --
--    Version   : 3.0.0.0                                                     --
--                                                                            --
-- This program is free software: you can redistribute it and / or modify     --
-- it under the terms of the GNU Lesser General Public License as published by--
-- the Free Software Foundation, either version 3 of the License, or          --
-- (at your option) any later version.                                        --
--                                                                            --
-- This program is distributed in the hope that it will be useful,            --
-- but WITHOUT ANY WARRANTY; without even the implied warranty of             --
-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the               --
-- GNU Lesser General Public License for more details.                        --
--                                                                            --
-- You should have received a copy of the GNU Lesser General Public License   --
-- along with this program.If not, see http://www.gnu.org/licenses            --
--                                                                            --
--------------------------------------------------------------------------------
with WinUI3.Windows.Foundation; use WinUI3.Windows.Foundation;
with Ada.Unchecked_Conversion;
with Ada.Unchecked_Deallocation;
--------------------------------------------------------------------------------
package body WinUI3.Windows.Security.Isolation is

   package IAsyncOperation_IsolatedWindowsEnvironmentStartProcessResult is new WinUI3.Windows.Foundation.IAsyncOperation (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentStartProcessResult);
   package AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult is new WinUI3.Windows.Foundation.AsyncOperationCompletedHandler (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentStartProcessResult);

   package IAsyncOperation_IsolatedWindowsEnvironmentShareFolderResult is new WinUI3.Windows.Foundation.IAsyncOperation (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderResult);
   package AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult is new WinUI3.Windows.Foundation.AsyncOperationCompletedHandler (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderResult);

   package IAsyncOperation_IsolatedWindowsEnvironmentLaunchFileResult is new WinUI3.Windows.Foundation.IAsyncOperation (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentLaunchFileResult);
   package AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult is new WinUI3.Windows.Foundation.AsyncOperationCompletedHandler (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentLaunchFileResult);

   package IAsyncOperation_IsolatedWindowsEnvironmentPostMessageResult is new WinUI3.Windows.Foundation.IAsyncOperation (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentPostMessageResult);
   package AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult is new WinUI3.Windows.Foundation.AsyncOperationCompletedHandler (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentPostMessageResult);

   package IAsyncOperation_IsolatedWindowsEnvironmentShareFileResult is new WinUI3.Windows.Foundation.IAsyncOperation (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileResult);
   package AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult is new WinUI3.Windows.Foundation.AsyncOperationCompletedHandler (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileResult);

   package IAsyncOperation_IsolatedWindowsEnvironmentCreateResult is new WinUI3.Windows.Foundation.IAsyncOperationWithProgress (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult, GenericObject);
   package AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult is new WinUI3.Windows.Foundation.AsyncOperationWithProgressCompletedHandler (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult, GenericObject);

   package IAsyncOperation_Boolean is new WinUI3.Windows.Foundation.IAsyncOperation (WinUI3.Boolean);
   package AsyncOperationCompletedHandler_Boolean is new WinUI3.Windows.Foundation.AsyncOperationCompletedHandler (WinUI3.Boolean);

   -----------------------------------------------------------------------------
   -- Delegate HostMessageReceivedCallback

   function Invoke
   (
      this : access HostMessageReceivedCallback_Delegate;
      receiverId : WinUI3.Guid;
      message : GenericObject
   )
   return WinUI3.Hresult is
      Hr : constant WinUI3.HResult := S_OK;
   begin
      this.Callback (receiverId, message);
      return Hr;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironment

   procedure Initialize (this : in out IsolatedWindowsEnvironment) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironment) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironment, IIsolatedWindowsEnvironment_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironment /= null then
         if this.m_IIsolatedWindowsEnvironment.all /= null then
            temp := this.m_IIsolatedWindowsEnvironment.all.Release;
            Free (this.m_IIsolatedWindowsEnvironment);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Static Interfaces for IsolatedWindowsEnvironment

   function CreateAsync
   (
      options : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentOptions'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreateResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsEnvironment");
      m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFactory_Interface'Class := null;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentCreateResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentCreateResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult;
      m_IID            : aliased WinUI3.IID := (3744642228, 17672, 22858, (131, 11, 180, 108, 237, 42, 74, 224 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentCreateResult;
      m_HandlerIID     : aliased WinUI3.IID := (1817075896, 60819, 24080, (150, 197, 250, 250, 219, 104, 255, 49 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentCreateResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreateResult do
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsEnvironmentFactory'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.CreateAsync (options.m_IIsolatedWindowsEnvironmentOptions.all, m_ComRetVal'Access);
            temp := m_Factory.Release;
            if Hr = S_OK then
               m_AsyncOperation := QI (m_ComRetVal);
               temp := m_ComRetVal.Release;
               if m_AsyncOperation /= null then
                  Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
                  while m_Captured = m_Compare loop
                     m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                     m_Captured := m_Completed;
                  end loop;
                  if m_AsyncStatus = Completed_e then
                     Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                     Retval.m_IIsolatedWindowsEnvironmentCreateResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult;
                     Retval.m_IIsolatedWindowsEnvironmentCreateResult.all := m_RetVal;
                  end if;
                  temp := m_AsyncOperation.Release;
                  temp := m_Handler.Release;
                  if temp = 0 then
                     Free (m_Handler);
                  end if;
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end return;
   end;

   function CreateAsync
   (
      options : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentOptions'Class;
      telemetryParameters : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentTelemetryParameters'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreateResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsEnvironment");
      m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFactory_Interface'Class := null;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentCreateResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentCreateResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult;
      m_IID            : aliased WinUI3.IID := (3744642228, 17672, 22858, (131, 11, 180, 108, 237, 42, 74, 224 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentCreateResult;
      m_HandlerIID     : aliased WinUI3.IID := (1817075896, 60819, 24080, (150, 197, 250, 250, 219, 104, 255, 49 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentCreateResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentCreateResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreateResult do
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsEnvironmentFactory'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.CreateAsync (options.m_IIsolatedWindowsEnvironmentOptions.all, telemetryParameters.m_IIsolatedWindowsEnvironmentTelemetryParameters.all, m_ComRetVal'Access);
            temp := m_Factory.Release;
            if Hr = S_OK then
               m_AsyncOperation := QI (m_ComRetVal);
               temp := m_ComRetVal.Release;
               if m_AsyncOperation /= null then
                  Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
                  while m_Captured = m_Compare loop
                     m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                     m_Captured := m_Completed;
                  end loop;
                  if m_AsyncStatus = Completed_e then
                     Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                     Retval.m_IIsolatedWindowsEnvironmentCreateResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult;
                     Retval.m_IIsolatedWindowsEnvironmentCreateResult.all := m_RetVal;
                  end if;
                  temp := m_AsyncOperation.Release;
                  temp := m_Handler.Release;
                  if temp = 0 then
                     Free (m_Handler);
                  end if;
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end return;
   end;

   function GetById
   (
      environmentId : WinUI3.WString
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironment is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsEnvironment");
      m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFactory_Interface'Class := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment;
      HStr_environmentId : constant WinUI3.HString := To_HString (environmentId);
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironment do
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsEnvironmentFactory'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.GetById (HStr_environmentId, m_ComRetVal'Access);
            temp := m_Factory.Release;
            if Hr /= S_OK then
               raise Program_Error;
            end if;
            Retval.m_IIsolatedWindowsEnvironment := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment;
            Retval.m_IIsolatedWindowsEnvironment.all := m_ComRetVal;
         end if;
         tmp := WindowsDeleteString (m_hString);
         tmp := WindowsDeleteString (HStr_environmentId);
      end return;
   end;

   function FindByOwnerId
   (
      environmentOwnerId : WinUI3.WString
   )
   return WinUI3.GenericObject is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsEnvironment");
      m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFactory_Interface'Class := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.GenericObject;
      HStr_environmentOwnerId : constant WinUI3.HString := To_HString (environmentOwnerId);
   begin
      Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsEnvironmentFactory'Access , m_Factory'Address);
      if Hr = S_OK then
         Hr := m_Factory.FindByOwnerId (HStr_environmentOwnerId, m_ComRetVal'Access);
         temp := m_Factory.Release;
         if Hr /= S_OK then
            raise Program_Error;
         end if;
      end if;
      tmp := WindowsDeleteString (m_hString);
      tmp := WindowsDeleteString (HStr_environmentOwnerId);
      return m_ComRetVal;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironment

   function get_Id
   (
      this : in out IsolatedWindowsEnvironment
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
   begin
      Hr := this.m_IIsolatedWindowsEnvironment.all.get_Id (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   function StartProcessSilentlyAsync
   (
      this : in out IsolatedWindowsEnvironment;
      hostExePath : WinUI3.WString;
      arguments : WinUI3.WString;
      activator : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentActivator
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentStartProcessResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      HStr_hostExePath : constant WinUI3.HString := To_HString (hostExePath);
      HStr_arguments : constant WinUI3.HString := To_HString (arguments);
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentStartProcessResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentStartProcessResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentStartProcessResult;
      m_IID            : aliased WinUI3.IID := (2093728671, 11178, 22343, (169, 136, 255, 163, 143, 20, 164, 70 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentStartProcessResult;
      m_HandlerIID     : aliased WinUI3.IID := (109545084, 24127, 21435, (145, 192, 204, 147, 25, 72, 213, 36 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentStartProcessResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentStartProcessResult do
         Hr := this.m_IIsolatedWindowsEnvironment.all.StartProcessSilentlyAsync (HStr_hostExePath, HStr_arguments, activator, m_ComRetVal'Access);
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentStartProcessResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentStartProcessResult;
                  Retval.m_IIsolatedWindowsEnvironmentStartProcessResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (HStr_hostExePath);
         tmp := WindowsDeleteString (HStr_arguments);
      end return;
   end;

   function StartProcessSilentlyAsync
   (
      this : in out IsolatedWindowsEnvironment;
      hostExePath : WinUI3.WString;
      arguments : WinUI3.WString;
      activator : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentActivator;
      telemetryParameters : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentTelemetryParameters'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentStartProcessResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      HStr_hostExePath : constant WinUI3.HString := To_HString (hostExePath);
      HStr_arguments : constant WinUI3.HString := To_HString (arguments);
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentStartProcessResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentStartProcessResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentStartProcessResult;
      m_IID            : aliased WinUI3.IID := (2093728671, 11178, 22343, (169, 136, 255, 163, 143, 20, 164, 70 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentStartProcessResult;
      m_HandlerIID     : aliased WinUI3.IID := (109545084, 24127, 21435, (145, 192, 204, 147, 25, 72, 213, 36 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentStartProcessResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentStartProcessResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentStartProcessResult do
         Hr := this.m_IIsolatedWindowsEnvironment.all.StartProcessSilentlyAsync (HStr_hostExePath, HStr_arguments, activator, telemetryParameters.m_IIsolatedWindowsEnvironmentTelemetryParameters.all, m_ComRetVal'Access);
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentStartProcessResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentStartProcessResult;
                  Retval.m_IIsolatedWindowsEnvironmentStartProcessResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (HStr_hostExePath);
         tmp := WindowsDeleteString (HStr_arguments);
      end return;
   end;

   function ShareFolderAsync
   (
      this : in out IsolatedWindowsEnvironment;
      hostFolder : WinUI3.WString;
      requestOptions : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderRequestOptions'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      HStr_hostFolder : constant WinUI3.HString := To_HString (hostFolder);
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentShareFolderResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentShareFolderResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderResult;
      m_IID            : aliased WinUI3.IID := (2302823917, 45594, 21933, (157, 74, 142, 83, 241, 84, 100, 162 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderResult;
      m_HandlerIID     : aliased WinUI3.IID := (1432112074, 54107, 24212, (184, 229, 167, 227, 196, 75, 209, 193 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentShareFolderResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderResult do
         Hr := this.m_IIsolatedWindowsEnvironment.all.ShareFolderAsync (HStr_hostFolder, requestOptions.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions.all, m_ComRetVal'Access);
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentShareFolderResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderResult;
                  Retval.m_IIsolatedWindowsEnvironmentShareFolderResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (HStr_hostFolder);
      end return;
   end;

   function ShareFolderAsync
   (
      this : in out IsolatedWindowsEnvironment;
      hostFolder : WinUI3.WString;
      requestOptions : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderRequestOptions'Class;
      telemetryParameters : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentTelemetryParameters'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      HStr_hostFolder : constant WinUI3.HString := To_HString (hostFolder);
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentShareFolderResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentShareFolderResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderResult;
      m_IID            : aliased WinUI3.IID := (2302823917, 45594, 21933, (157, 74, 142, 83, 241, 84, 100, 162 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderResult;
      m_HandlerIID     : aliased WinUI3.IID := (1432112074, 54107, 24212, (184, 229, 167, 227, 196, 75, 209, 193 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentShareFolderResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFolderResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderResult do
         Hr := this.m_IIsolatedWindowsEnvironment.all.ShareFolderAsync (HStr_hostFolder, requestOptions.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions.all, telemetryParameters.m_IIsolatedWindowsEnvironmentTelemetryParameters.all, m_ComRetVal'Access);
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentShareFolderResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderResult;
                  Retval.m_IIsolatedWindowsEnvironmentShareFolderResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (HStr_hostFolder);
      end return;
   end;

   function LaunchFileWithUIAsync
   (
      this : in out IsolatedWindowsEnvironment;
      appExePath : WinUI3.WString;
      argumentsTemplate : WinUI3.WString;
      filePath : WinUI3.WString
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentLaunchFileResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      HStr_appExePath : constant WinUI3.HString := To_HString (appExePath);
      HStr_argumentsTemplate : constant WinUI3.HString := To_HString (argumentsTemplate);
      HStr_filePath : constant WinUI3.HString := To_HString (filePath);
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentLaunchFileResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentLaunchFileResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentLaunchFileResult;
      m_IID            : aliased WinUI3.IID := (2944999330, 16265, 24155, (167, 43, 223, 147, 107, 177, 173, 69 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentLaunchFileResult;
      m_HandlerIID     : aliased WinUI3.IID := (2484004965, 35980, 23403, (136, 246, 160, 55, 31, 88, 179, 134 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentLaunchFileResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentLaunchFileResult do
         Hr := this.m_IIsolatedWindowsEnvironment.all.LaunchFileWithUIAsync (HStr_appExePath, HStr_argumentsTemplate, HStr_filePath, m_ComRetVal'Access);
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentLaunchFileResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentLaunchFileResult;
                  Retval.m_IIsolatedWindowsEnvironmentLaunchFileResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (HStr_appExePath);
         tmp := WindowsDeleteString (HStr_argumentsTemplate);
         tmp := WindowsDeleteString (HStr_filePath);
      end return;
   end;

   function LaunchFileWithUIAsync
   (
      this : in out IsolatedWindowsEnvironment;
      appExePath : WinUI3.WString;
      argumentsTemplate : WinUI3.WString;
      filePath : WinUI3.WString;
      telemetryParameters : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentTelemetryParameters'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentLaunchFileResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      HStr_appExePath : constant WinUI3.HString := To_HString (appExePath);
      HStr_argumentsTemplate : constant WinUI3.HString := To_HString (argumentsTemplate);
      HStr_filePath : constant WinUI3.HString := To_HString (filePath);
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentLaunchFileResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentLaunchFileResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentLaunchFileResult;
      m_IID            : aliased WinUI3.IID := (2944999330, 16265, 24155, (167, 43, 223, 147, 107, 177, 173, 69 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentLaunchFileResult;
      m_HandlerIID     : aliased WinUI3.IID := (2484004965, 35980, 23403, (136, 246, 160, 55, 31, 88, 179, 134 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentLaunchFileResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentLaunchFileResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentLaunchFileResult do
         Hr := this.m_IIsolatedWindowsEnvironment.all.LaunchFileWithUIAsync (HStr_appExePath, HStr_argumentsTemplate, HStr_filePath, telemetryParameters.m_IIsolatedWindowsEnvironmentTelemetryParameters.all, m_ComRetVal'Access);
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentLaunchFileResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentLaunchFileResult;
                  Retval.m_IIsolatedWindowsEnvironmentLaunchFileResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (HStr_appExePath);
         tmp := WindowsDeleteString (HStr_argumentsTemplate);
         tmp := WindowsDeleteString (HStr_filePath);
      end return;
   end;

   procedure TerminateAsync
   (
      this : in out IsolatedWindowsEnvironment
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.IAsyncAction := null;

      procedure IAsyncAction_Callback (asyncInfo : WinUI3.Windows.Foundation.IAsyncAction; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
      begin
         if asyncStatus = Completed_e then
            Hr := asyncInfo.GetResults;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

      m_CompletedHandler : WinUI3.Windows.Foundation.AsyncActionCompletedHandler := new WinUI3.Windows.Foundation.AsyncActionCompletedHandler_Delegate'(IAsyncAction_Callback'Access, 1, null);
      procedure Free is new Ada.Unchecked_Deallocation (WinUI3.Windows.Foundation.AsyncActionCompletedHandler_Delegate, WinUI3.Windows.Foundation.AsyncActionCompletedHandler);

   begin
      Hr := this.m_IIsolatedWindowsEnvironment.all.TerminateAsync (m_ComRetVal'Access);
      if Hr = S_OK then
         m_Captured := m_Completed;
         Hr := m_ComRetVal.Put_Completed (m_CompletedHandler);
         while m_Captured = m_Compare loop
            m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
            m_Captured := m_Completed;
         end loop;
         temp := m_ComRetVal.Release;
         temp := m_CompletedHandler.Release;
         if temp = 0 then
            Free (m_CompletedHandler);
         end if;
      end if;
   end;

   procedure TerminateAsync
   (
      this : in out IsolatedWindowsEnvironment;
      telemetryParameters : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentTelemetryParameters'Class
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.IAsyncAction := null;

      procedure IAsyncAction_Callback (asyncInfo : WinUI3.Windows.Foundation.IAsyncAction; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
      begin
         if asyncStatus = Completed_e then
            Hr := asyncInfo.GetResults;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

      m_CompletedHandler : WinUI3.Windows.Foundation.AsyncActionCompletedHandler := new WinUI3.Windows.Foundation.AsyncActionCompletedHandler_Delegate'(IAsyncAction_Callback'Access, 1, null);
      procedure Free is new Ada.Unchecked_Deallocation (WinUI3.Windows.Foundation.AsyncActionCompletedHandler_Delegate, WinUI3.Windows.Foundation.AsyncActionCompletedHandler);

   begin
      Hr := this.m_IIsolatedWindowsEnvironment.all.TerminateAsync (telemetryParameters.m_IIsolatedWindowsEnvironmentTelemetryParameters.all, m_ComRetVal'Access);
      if Hr = S_OK then
         m_Captured := m_Completed;
         Hr := m_ComRetVal.Put_Completed (m_CompletedHandler);
         while m_Captured = m_Compare loop
            m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
            m_Captured := m_Completed;
         end loop;
         temp := m_ComRetVal.Release;
         temp := m_CompletedHandler.Release;
         if temp = 0 then
            Free (m_CompletedHandler);
         end if;
      end if;
   end;

   procedure RegisterMessageReceiver
   (
      this : in out IsolatedWindowsEnvironment;
      receiverId : WinUI3.Guid;
      messageReceivedCallback : WinUI3.Windows.Security.Isolation.MessageReceivedCallback
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironment.all.RegisterMessageReceiver (receiverId, messageReceivedCallback);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   procedure UnregisterMessageReceiver
   (
      this : in out IsolatedWindowsEnvironment;
      receiverId : WinUI3.Guid
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironment.all.UnregisterMessageReceiver (receiverId);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function PostMessageToReceiverAsync
   (
      this : in out IsolatedWindowsEnvironment;
      receiverId : WinUI3.Guid;
      message : GenericObject
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentPostMessageResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment2 := null;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentPostMessageResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentPostMessageResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentPostMessageResult;
      m_IID            : aliased WinUI3.IID := (1041661360, 31107, 21289, (131, 160, 4, 119, 118, 60, 196, 203 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentPostMessageResult;
      m_HandlerIID     : aliased WinUI3.IID := (882935011, 56997, 24155, (141, 134, 163, 21, 132, 231, 72, 147 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentPostMessageResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment2, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironment2'Unchecked_Access);
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentPostMessageResult do
         m_Interface := QInterface (this.m_IIsolatedWindowsEnvironment.all);
         Hr := m_Interface.PostMessageToReceiverAsync (receiverId, message, m_ComRetVal'Access);
         temp := m_Interface.Release;
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentPostMessageResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentPostMessageResult;
                  Retval.m_IIsolatedWindowsEnvironmentPostMessageResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
      end return;
   end;

   function PostMessageToReceiverAsync
   (
      this : in out IsolatedWindowsEnvironment;
      receiverId : WinUI3.Guid;
      message : GenericObject;
      telemetryParameters : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentTelemetryParameters'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentPostMessageResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment2 := null;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentPostMessageResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentPostMessageResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentPostMessageResult;
      m_IID            : aliased WinUI3.IID := (1041661360, 31107, 21289, (131, 160, 4, 119, 118, 60, 196, 203 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentPostMessageResult;
      m_HandlerIID     : aliased WinUI3.IID := (882935011, 56997, 24155, (141, 134, 163, 21, 132, 231, 72, 147 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentPostMessageResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentPostMessageResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment2, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironment2'Unchecked_Access);
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentPostMessageResult do
         m_Interface := QInterface (this.m_IIsolatedWindowsEnvironment.all);
         Hr := m_Interface.PostMessageToReceiverAsync (receiverId, message, telemetryParameters.m_IIsolatedWindowsEnvironmentTelemetryParameters.all, m_ComRetVal'Access);
         temp := m_Interface.Release;
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentPostMessageResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentPostMessageResult;
                  Retval.m_IIsolatedWindowsEnvironmentPostMessageResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
      end return;
   end;

   function GetUserInfo
   (
      this : in out IsolatedWindowsEnvironment
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentUserInfo'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment3 := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentUserInfo;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironment3'Unchecked_Access);
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentUserInfo do
         m_Interface := QInterface (this.m_IIsolatedWindowsEnvironment.all);
         Hr := m_Interface.GetUserInfo (m_ComRetVal'Access);
         temp := m_Interface.Release;
         if Hr /= S_OK then
            raise Program_Error;
         end if;
         Retval.m_IIsolatedWindowsEnvironmentUserInfo := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentUserInfo;
         Retval.m_IIsolatedWindowsEnvironmentUserInfo.all := m_ComRetVal;
      end return;
   end;

   function ShareFileAsync
   (
      this : in out IsolatedWindowsEnvironment;
      filePath : WinUI3.WString;
      options : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileRequestOptions'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment3 := null;
      temp             : WinUI3.UInt32 := 0;
      HStr_filePath : constant WinUI3.HString := To_HString (filePath);
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentShareFileResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentShareFileResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileResult;
      m_IID            : aliased WinUI3.IID := (1993242303, 60421, 20797, (132, 63, 121, 175, 23, 102, 228, 144 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileResult;
      m_HandlerIID     : aliased WinUI3.IID := (2343347041, 10549, 21077, (132, 220, 28, 133, 79, 79, 239, 105 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentShareFileResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironment3'Unchecked_Access);
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileResult do
         m_Interface := QInterface (this.m_IIsolatedWindowsEnvironment.all);
         Hr := m_Interface.ShareFileAsync (HStr_filePath, options.m_IIsolatedWindowsEnvironmentShareFileRequestOptions.all, m_ComRetVal'Access);
         temp := m_Interface.Release;
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentShareFileResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileResult;
                  Retval.m_IIsolatedWindowsEnvironmentShareFileResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (HStr_filePath);
      end return;
   end;

   function ShareFileAsync
   (
      this : in out IsolatedWindowsEnvironment;
      filePath : WinUI3.WString;
      options : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileRequestOptions'Class;
      telemetryParameters : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentTelemetryParameters'Class
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileResult'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment3 := null;
      temp             : WinUI3.UInt32 := 0;
      HStr_filePath : constant WinUI3.HString := To_HString (filePath);
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_IsolatedWindowsEnvironmentShareFileResult.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_IsolatedWindowsEnvironmentShareFileResult.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileResult;
      m_IID            : aliased WinUI3.IID := (1993242303, 60421, 20797, (132, 63, 121, 175, 23, 102, 228, 144 )); -- Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileResult;
      m_HandlerIID     : aliased WinUI3.IID := (2343347041, 10549, 21077, (132, 220, 28, 133, 79, 79, 239, 105 ));
      m_Handler        : AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind := new AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_IsolatedWindowsEnvironmentShareFileResult.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind_Delegate, AsyncOperationCompletedHandler_IsolatedWindowsEnvironmentShareFileResult.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironment3'Unchecked_Access);
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileResult do
         m_Interface := QInterface (this.m_IIsolatedWindowsEnvironment.all);
         Hr := m_Interface.ShareFileAsync (HStr_filePath, options.m_IIsolatedWindowsEnvironmentShareFileRequestOptions.all, telemetryParameters.m_IIsolatedWindowsEnvironmentTelemetryParameters.all, m_ComRetVal'Access);
         temp := m_Interface.Release;
         if Hr = S_OK then
            m_AsyncOperation := QI (m_ComRetVal);
            temp := m_ComRetVal.Release;
            if m_AsyncOperation /= null then
               Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
               while m_Captured = m_Compare loop
                  m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
                  m_Captured := m_Completed;
               end loop;
               if m_AsyncStatus = Completed_e then
                  Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
                  Retval.m_IIsolatedWindowsEnvironmentShareFileResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileResult;
                  Retval.m_IIsolatedWindowsEnvironmentShareFileResult.all := m_RetVal;
               end if;
               temp := m_AsyncOperation.Release;
               temp := m_Handler.Release;
               if temp = 0 then
                  Free (m_Handler);
               end if;
            end if;
         end if;
         tmp := WindowsDeleteString (HStr_filePath);
      end return;
   end;

   procedure ChangePriority
   (
      this : in out IsolatedWindowsEnvironment;
      Priority : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreationPriority
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment4 := null;
      temp             : WinUI3.UInt32 := 0;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment4, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironment4'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironment.all);
      Hr := m_Interface.ChangePriority (Priority);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentCreateResult

   procedure Initialize (this : in out IsolatedWindowsEnvironmentCreateResult) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentCreateResult) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentCreateResult, IIsolatedWindowsEnvironmentCreateResult_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentCreateResult /= null then
         if this.m_IIsolatedWindowsEnvironmentCreateResult.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentCreateResult.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentCreateResult);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentCreateResult

   function get_Status
   (
      this : in out IsolatedWindowsEnvironmentCreateResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreateStatus is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreateStatus;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentCreateResult.all.get_Status (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_ExtendedError
   (
      this : in out IsolatedWindowsEnvironmentCreateResult
   )
   return WinUI3.Windows.Foundation.HResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.HResult;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentCreateResult.all.get_ExtendedError (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_Environment
   (
      this : in out IsolatedWindowsEnvironmentCreateResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironment'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment;
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironment do
         Hr := this.m_IIsolatedWindowsEnvironmentCreateResult.all.get_Environment (m_ComRetVal'Access);
         if Hr /= S_OK then
            raise Program_Error;
         end if;
         Retval.m_IIsolatedWindowsEnvironment := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironment;
         Retval.m_IIsolatedWindowsEnvironment.all := m_ComRetVal;
      end return;
   end;

   procedure ChangeCreationPriority
   (
      this : in out IsolatedWindowsEnvironmentCreateResult;
      priority : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreationPriority
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult2 := null;
      temp             : WinUI3.UInt32 := 0;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentCreateResult2, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentCreateResult2'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentCreateResult.all);
      Hr := m_Interface.ChangeCreationPriority (priority);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentFile

   procedure Initialize (this : in out IsolatedWindowsEnvironmentFile) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentFile) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentFile, IIsolatedWindowsEnvironmentFile_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentFile /= null then
         if this.m_IIsolatedWindowsEnvironmentFile.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentFile.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentFile);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentFile

   function get_Id
   (
      this : in out IsolatedWindowsEnvironmentFile
   )
   return WinUI3.Guid is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Guid;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentFile.all.get_Id (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_HostPath
   (
      this : in out IsolatedWindowsEnvironmentFile
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentFile.all.get_HostPath (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   procedure Close
   (
      this : in out IsolatedWindowsEnvironmentFile
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentFile.all.Close;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_GuestPath
   (
      this : in out IsolatedWindowsEnvironmentFile
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile2 := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile2, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentFile2'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentFile.all);
      Hr := m_Interface.get_GuestPath (m_ComRetVal'Access);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   function get_IsReadOnly
   (
      this : in out IsolatedWindowsEnvironmentFile
   )
   return WinUI3.Boolean is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile2 := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Boolean;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile2, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentFile2'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentFile.all);
      Hr := m_Interface.get_IsReadOnly (m_ComRetVal'Access);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   -----------------------------------------------------------------------------
   -- Static RuntimeClass
   package body IsolatedWindowsEnvironmentHost is

      function get_IsReady
      return WinUI3.Boolean is
         Hr               : WinUI3.HResult := S_OK;
         tmp              : WinUI3.HResult := S_OK;
         m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsEnvironmentHost");
         m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentHostStatics_Interface'Class := null;
         temp             : WinUI3.UInt32 := 0;
         m_ComRetVal      : aliased WinUI3.Boolean;
      begin
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsEnvironmentHostStatics'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.get_IsReady (m_ComRetVal'Access);
            temp := m_Factory.Release;
            if Hr /= S_OK then
               raise Program_Error;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
         return m_ComRetVal;
      end;

      function get_HostErrors
      return WinUI3.GenericObject is
         Hr               : WinUI3.HResult := S_OK;
         tmp              : WinUI3.HResult := S_OK;
         m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsEnvironmentHost");
         m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentHostStatics_Interface'Class := null;
         temp             : WinUI3.UInt32 := 0;
         m_ComRetVal      : aliased WinUI3.GenericObject;
      begin
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsEnvironmentHostStatics'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.get_HostErrors (m_ComRetVal'Access);
            temp := m_Factory.Release;
            if Hr /= S_OK then
               raise Program_Error;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
         return m_ComRetVal;
      end;

   end IsolatedWindowsEnvironmentHost;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentLaunchFileResult

   procedure Initialize (this : in out IsolatedWindowsEnvironmentLaunchFileResult) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentLaunchFileResult) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentLaunchFileResult, IIsolatedWindowsEnvironmentLaunchFileResult_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentLaunchFileResult /= null then
         if this.m_IIsolatedWindowsEnvironmentLaunchFileResult.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentLaunchFileResult.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentLaunchFileResult);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentLaunchFileResult

   function get_Status
   (
      this : in out IsolatedWindowsEnvironmentLaunchFileResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentLaunchFileStatus is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentLaunchFileStatus;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentLaunchFileResult.all.get_Status (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_ExtendedError
   (
      this : in out IsolatedWindowsEnvironmentLaunchFileResult
   )
   return WinUI3.Windows.Foundation.HResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.HResult;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentLaunchFileResult.all.get_ExtendedError (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_File
   (
      this : in out IsolatedWindowsEnvironmentLaunchFileResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentFile'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile;
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentFile do
         Hr := this.m_IIsolatedWindowsEnvironmentLaunchFileResult.all.get_File (m_ComRetVal'Access);
         if Hr /= S_OK then
            raise Program_Error;
         end if;
         Retval.m_IIsolatedWindowsEnvironmentFile := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile;
         Retval.m_IIsolatedWindowsEnvironmentFile.all := m_ComRetVal;
      end return;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentOptions

   procedure Initialize (this : in out IsolatedWindowsEnvironmentOptions) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentOptions) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentOptions, IIsolatedWindowsEnvironmentOptions_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentOptions /= null then
         if this.m_IIsolatedWindowsEnvironmentOptions.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentOptions.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentOptions);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Constructors for IsolatedWindowsEnvironmentOptions

   function Constructor return IsolatedWindowsEnvironmentOptions is
      Hr           : WinUI3.HResult := S_OK;
      tmp          : WinUI3.HResult := S_OK;
      m_hString    : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions");
      m_ComRetVal  : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions;
   begin
      return RetVal : IsolatedWindowsEnvironmentOptions do
         Hr := RoActivateInstance (m_hString, m_ComRetVal'Address);
         if Hr = S_OK then
            Retval.m_IIsolatedWindowsEnvironmentOptions := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions;
            Retval.m_IIsolatedWindowsEnvironmentOptions.all := m_ComRetVal;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end return;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentOptions

   function get_EnvironmentOwnerId
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_EnvironmentOwnerId (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   procedure put_EnvironmentOwnerId
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.WString
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      HStr_value : constant WinUI3.HString := To_HString (value);
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.put_EnvironmentOwnerId (HStr_value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      tmp := WindowsDeleteString (HStr_value);
   end;

   function get_AllowedClipboardFormats
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_AllowedClipboardFormats (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_AllowedClipboardFormats
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.put_AllowedClipboardFormats (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_ClipboardCopyPasteDirections
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentClipboardCopyPasteDirections is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentClipboardCopyPasteDirections;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_ClipboardCopyPasteDirections (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_ClipboardCopyPasteDirections
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentClipboardCopyPasteDirections
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.put_ClipboardCopyPasteDirections (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_AvailablePrinters
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAvailablePrinters is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAvailablePrinters;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_AvailablePrinters (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_AvailablePrinters
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAvailablePrinters
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.put_AvailablePrinters (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_SharedHostFolderPath
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_SharedHostFolderPath (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   function get_SharedFolderNameInEnvironment
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_SharedFolderNameInEnvironment (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   procedure ShareHostFolderForUntrustedItems
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      SharedHostFolderPath : WinUI3.WString;
      ShareFolderNameInEnvironment : WinUI3.WString
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      HStr_SharedHostFolderPath : constant WinUI3.HString := To_HString (SharedHostFolderPath);
      HStr_ShareFolderNameInEnvironment : constant WinUI3.HString := To_HString (ShareFolderNameInEnvironment);
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.ShareHostFolderForUntrustedItems (HStr_SharedHostFolderPath, HStr_ShareFolderNameInEnvironment);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      tmp := WindowsDeleteString (HStr_SharedHostFolderPath);
      tmp := WindowsDeleteString (HStr_ShareFolderNameInEnvironment);
   end;

   function get_PersistUserProfile
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Boolean is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Boolean;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_PersistUserProfile (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_PersistUserProfile
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Boolean
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.put_PersistUserProfile (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_AllowGraphicsHardwareAcceleration
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Boolean is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Boolean;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_AllowGraphicsHardwareAcceleration (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_AllowGraphicsHardwareAcceleration
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Boolean
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.put_AllowGraphicsHardwareAcceleration (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_AllowCameraAndMicrophoneAccess
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Boolean is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Boolean;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.get_AllowCameraAndMicrophoneAccess (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_AllowCameraAndMicrophoneAccess
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Boolean
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOptions.all.put_AllowCameraAndMicrophoneAccess (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_WindowAnnotationOverride
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions2 := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions2, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentOptions2'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentOptions.all);
      Hr := m_Interface.get_WindowAnnotationOverride (m_ComRetVal'Access);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   procedure put_WindowAnnotationOverride
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.WString
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions2 := null;
      temp             : WinUI3.UInt32 := 0;
      HStr_value : constant WinUI3.HString := To_HString (value);
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions2, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentOptions2'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentOptions.all);
      Hr := m_Interface.put_WindowAnnotationOverride (HStr_value);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      tmp := WindowsDeleteString (HStr_value);
   end;

   function get_AllowedClipboardFormatsToEnvironment
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3 := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentOptions3'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentOptions.all);
      Hr := m_Interface.get_AllowedClipboardFormatsToEnvironment (m_ComRetVal'Access);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_AllowedClipboardFormatsToEnvironment
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3 := null;
      temp             : WinUI3.UInt32 := 0;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentOptions3'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentOptions.all);
      Hr := m_Interface.put_AllowedClipboardFormatsToEnvironment (value);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_AllowedClipboardFormatsToHost
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3 := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentOptions3'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentOptions.all);
      Hr := m_Interface.get_AllowedClipboardFormatsToHost (m_ComRetVal'Access);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_AllowedClipboardFormatsToHost
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentAllowedClipboardFormats
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3 := null;
      temp             : WinUI3.UInt32 := 0;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentOptions3'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentOptions.all);
      Hr := m_Interface.put_AllowedClipboardFormatsToHost (value);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   function get_CreationPriority
   (
      this : in out IsolatedWindowsEnvironmentOptions
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreationPriority is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3 := null;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreationPriority;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentOptions3'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentOptions.all);
      Hr := m_Interface.get_CreationPriority (m_ComRetVal'Access);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_CreationPriority
   (
      this : in out IsolatedWindowsEnvironmentOptions;
      value : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentCreationPriority
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3 := null;
      temp             : WinUI3.UInt32 := 0;
      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOptions3, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentOptions3'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentOptions.all);
      Hr := m_Interface.put_CreationPriority (value);
      temp := m_Interface.Release;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Static RuntimeClass
   package body IsolatedWindowsEnvironmentOwnerRegistration is

      function Register
      (
         ownerName : WinUI3.WString;
         ownerRegistrationData : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentOwnerRegistrationData'Class
      )
      return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentOwnerRegistrationResult is
         Hr               : WinUI3.HResult := S_OK;
         tmp              : WinUI3.HResult := S_OK;
         m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsEnvironmentOwnerRegistration");
         m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOwnerRegistrationStatics_Interface'Class := null;
         temp             : WinUI3.UInt32 := 0;
         m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOwnerRegistrationResult;
         HStr_ownerName : constant WinUI3.HString := To_HString (ownerName);
      begin
         return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentOwnerRegistrationResult do
            Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsEnvironmentOwnerRegistrationStatics'Access , m_Factory'Address);
            if Hr = S_OK then
               Hr := m_Factory.Register (HStr_ownerName, ownerRegistrationData.m_IIsolatedWindowsEnvironmentOwnerRegistrationData.all, m_ComRetVal'Access);
               temp := m_Factory.Release;
               if Hr /= S_OK then
                  raise Program_Error;
               end if;
               Retval.m_IIsolatedWindowsEnvironmentOwnerRegistrationResult := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOwnerRegistrationResult;
               Retval.m_IIsolatedWindowsEnvironmentOwnerRegistrationResult.all := m_ComRetVal;
            end if;
            tmp := WindowsDeleteString (m_hString);
            tmp := WindowsDeleteString (HStr_ownerName);
         end return;
      end;

      procedure Unregister
      (
         ownerName : WinUI3.WString
      ) is
         Hr               : WinUI3.HResult := S_OK;
         tmp              : WinUI3.HResult := S_OK;
         m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsEnvironmentOwnerRegistration");
         m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOwnerRegistrationStatics_Interface'Class := null;
         temp             : WinUI3.UInt32 := 0;
         HStr_ownerName : constant WinUI3.HString := To_HString (ownerName);
      begin
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsEnvironmentOwnerRegistrationStatics'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.Unregister (HStr_ownerName);
            temp := m_Factory.Release;
            if Hr /= S_OK then
               raise Program_Error;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
         tmp := WindowsDeleteString (HStr_ownerName);
      end;

   end IsolatedWindowsEnvironmentOwnerRegistration;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentOwnerRegistrationData

   procedure Initialize (this : in out IsolatedWindowsEnvironmentOwnerRegistrationData) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentOwnerRegistrationData) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentOwnerRegistrationData, IIsolatedWindowsEnvironmentOwnerRegistrationData_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentOwnerRegistrationData /= null then
         if this.m_IIsolatedWindowsEnvironmentOwnerRegistrationData.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentOwnerRegistrationData.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentOwnerRegistrationData);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Constructors for IsolatedWindowsEnvironmentOwnerRegistrationData

   function Constructor return IsolatedWindowsEnvironmentOwnerRegistrationData is
      Hr           : WinUI3.HResult := S_OK;
      tmp          : WinUI3.HResult := S_OK;
      m_hString    : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IIsolatedWindowsEnvironmentOwnerRegistrationData");
      m_ComRetVal  : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOwnerRegistrationData;
   begin
      return RetVal : IsolatedWindowsEnvironmentOwnerRegistrationData do
         Hr := RoActivateInstance (m_hString, m_ComRetVal'Address);
         if Hr = S_OK then
            Retval.m_IIsolatedWindowsEnvironmentOwnerRegistrationData := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentOwnerRegistrationData;
            Retval.m_IIsolatedWindowsEnvironmentOwnerRegistrationData.all := m_ComRetVal;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end return;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentOwnerRegistrationData

   function get_ShareableFolders
   (
      this : in out IsolatedWindowsEnvironmentOwnerRegistrationData
   )
   return IVector_HString.Kind is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.GenericObject;
      m_GenericRetval  : aliased IVector_HString.Kind;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOwnerRegistrationData.all.get_ShareableFolders (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      m_GenericRetVal := QInterface_IVector_HString (m_ComRetVal);
      temp := m_ComRetVal.Release;
      return m_GenericRetVal;
   end;

   function get_ProcessesRunnableAsSystem
   (
      this : in out IsolatedWindowsEnvironmentOwnerRegistrationData
   )
   return IVector_HString.Kind is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.GenericObject;
      m_GenericRetval  : aliased IVector_HString.Kind;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOwnerRegistrationData.all.get_ProcessesRunnableAsSystem (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      m_GenericRetVal := QInterface_IVector_HString (m_ComRetVal);
      temp := m_ComRetVal.Release;
      return m_GenericRetVal;
   end;

   function get_ProcessesRunnableAsUser
   (
      this : in out IsolatedWindowsEnvironmentOwnerRegistrationData
   )
   return IVector_HString.Kind is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.GenericObject;
      m_GenericRetval  : aliased IVector_HString.Kind;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOwnerRegistrationData.all.get_ProcessesRunnableAsUser (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      m_GenericRetVal := QInterface_IVector_HString (m_ComRetVal);
      temp := m_ComRetVal.Release;
      return m_GenericRetVal;
   end;

   function get_ActivationFileExtensions
   (
      this : in out IsolatedWindowsEnvironmentOwnerRegistrationData
   )
   return IVector_HString.Kind is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.GenericObject;
      m_GenericRetval  : aliased IVector_HString.Kind;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOwnerRegistrationData.all.get_ActivationFileExtensions (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      m_GenericRetVal := QInterface_IVector_HString (m_ComRetVal);
      temp := m_ComRetVal.Release;
      return m_GenericRetVal;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentOwnerRegistrationResult

   procedure Initialize (this : in out IsolatedWindowsEnvironmentOwnerRegistrationResult) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentOwnerRegistrationResult) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentOwnerRegistrationResult, IIsolatedWindowsEnvironmentOwnerRegistrationResult_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentOwnerRegistrationResult /= null then
         if this.m_IIsolatedWindowsEnvironmentOwnerRegistrationResult.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentOwnerRegistrationResult.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentOwnerRegistrationResult);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentOwnerRegistrationResult

   function get_Status
   (
      this : in out IsolatedWindowsEnvironmentOwnerRegistrationResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentOwnerRegistrationStatus is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentOwnerRegistrationStatus;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOwnerRegistrationResult.all.get_Status (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_ExtendedError
   (
      this : in out IsolatedWindowsEnvironmentOwnerRegistrationResult
   )
   return WinUI3.Windows.Foundation.HResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.HResult;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentOwnerRegistrationResult.all.get_ExtendedError (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentPostMessageResult

   procedure Initialize (this : in out IsolatedWindowsEnvironmentPostMessageResult) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentPostMessageResult) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentPostMessageResult, IIsolatedWindowsEnvironmentPostMessageResult_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentPostMessageResult /= null then
         if this.m_IIsolatedWindowsEnvironmentPostMessageResult.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentPostMessageResult.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentPostMessageResult);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentPostMessageResult

   function get_Status
   (
      this : in out IsolatedWindowsEnvironmentPostMessageResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentPostMessageStatus is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentPostMessageStatus;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentPostMessageResult.all.get_Status (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_ExtendedError
   (
      this : in out IsolatedWindowsEnvironmentPostMessageResult
   )
   return WinUI3.Windows.Foundation.HResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.HResult;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentPostMessageResult.all.get_ExtendedError (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentProcess

   procedure Initialize (this : in out IsolatedWindowsEnvironmentProcess) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentProcess) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentProcess, IIsolatedWindowsEnvironmentProcess_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentProcess /= null then
         if this.m_IIsolatedWindowsEnvironmentProcess.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentProcess.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentProcess);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentProcess

   function get_State
   (
      this : in out IsolatedWindowsEnvironmentProcess
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentProcessState is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentProcessState;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentProcess.all.get_State (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_ExitCode
   (
      this : in out IsolatedWindowsEnvironmentProcess
   )
   return WinUI3.UInt32 is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.UInt32;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentProcess.all.get_ExitCode (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure WaitForExit
   (
      this : in out IsolatedWindowsEnvironmentProcess
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentProcess.all.WaitForExit;
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   procedure WaitForExitWithTimeout
   (
      this : in out IsolatedWindowsEnvironmentProcess;
      timeoutMilliseconds : WinUI3.UInt32
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentProcess.all.WaitForExitWithTimeout (timeoutMilliseconds);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   procedure WaitForExitAsync
   (
      this : in out IsolatedWindowsEnvironmentProcess
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.IAsyncAction := null;

      procedure IAsyncAction_Callback (asyncInfo : WinUI3.Windows.Foundation.IAsyncAction; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
      begin
         if asyncStatus = Completed_e then
            Hr := asyncInfo.GetResults;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

      m_CompletedHandler : WinUI3.Windows.Foundation.AsyncActionCompletedHandler := new WinUI3.Windows.Foundation.AsyncActionCompletedHandler_Delegate'(IAsyncAction_Callback'Access, 1, null);
      procedure Free is new Ada.Unchecked_Deallocation (WinUI3.Windows.Foundation.AsyncActionCompletedHandler_Delegate, WinUI3.Windows.Foundation.AsyncActionCompletedHandler);

   begin
      Hr := this.m_IIsolatedWindowsEnvironmentProcess.all.WaitForExitAsync (m_ComRetVal'Access);
      if Hr = S_OK then
         m_Captured := m_Completed;
         Hr := m_ComRetVal.Put_Completed (m_CompletedHandler);
         while m_Captured = m_Compare loop
            m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
            m_Captured := m_Completed;
         end loop;
         temp := m_ComRetVal.Release;
         temp := m_CompletedHandler.Release;
         if temp = 0 then
            Free (m_CompletedHandler);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentShareFileRequestOptions

   procedure Initialize (this : in out IsolatedWindowsEnvironmentShareFileRequestOptions) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentShareFileRequestOptions) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentShareFileRequestOptions, IIsolatedWindowsEnvironmentShareFileRequestOptions_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentShareFileRequestOptions /= null then
         if this.m_IIsolatedWindowsEnvironmentShareFileRequestOptions.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentShareFileRequestOptions.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentShareFileRequestOptions);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Constructors for IsolatedWindowsEnvironmentShareFileRequestOptions

   function Constructor return IsolatedWindowsEnvironmentShareFileRequestOptions is
      Hr           : WinUI3.HResult := S_OK;
      tmp          : WinUI3.HResult := S_OK;
      m_hString    : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileRequestOptions");
      m_ComRetVal  : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileRequestOptions;
   begin
      return RetVal : IsolatedWindowsEnvironmentShareFileRequestOptions do
         Hr := RoActivateInstance (m_hString, m_ComRetVal'Address);
         if Hr = S_OK then
            Retval.m_IIsolatedWindowsEnvironmentShareFileRequestOptions := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFileRequestOptions;
            Retval.m_IIsolatedWindowsEnvironmentShareFileRequestOptions.all := m_ComRetVal;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end return;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentShareFileRequestOptions

   function get_AllowWrite
   (
      this : in out IsolatedWindowsEnvironmentShareFileRequestOptions
   )
   return WinUI3.Boolean is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Boolean;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentShareFileRequestOptions.all.get_AllowWrite (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_AllowWrite
   (
      this : in out IsolatedWindowsEnvironmentShareFileRequestOptions;
      value : WinUI3.Boolean
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentShareFileRequestOptions.all.put_AllowWrite (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentShareFileResult

   procedure Initialize (this : in out IsolatedWindowsEnvironmentShareFileResult) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentShareFileResult) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentShareFileResult, IIsolatedWindowsEnvironmentShareFileResult_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentShareFileResult /= null then
         if this.m_IIsolatedWindowsEnvironmentShareFileResult.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentShareFileResult.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentShareFileResult);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentShareFileResult

   function get_Status
   (
      this : in out IsolatedWindowsEnvironmentShareFileResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileStatus is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFileStatus;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentShareFileResult.all.get_Status (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_ExtendedError
   (
      this : in out IsolatedWindowsEnvironmentShareFileResult
   )
   return WinUI3.Windows.Foundation.HResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.HResult;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentShareFileResult.all.get_ExtendedError (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_File
   (
      this : in out IsolatedWindowsEnvironmentShareFileResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentFile'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile;
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentFile do
         Hr := this.m_IIsolatedWindowsEnvironmentShareFileResult.all.get_File (m_ComRetVal'Access);
         if Hr /= S_OK then
            raise Program_Error;
         end if;
         Retval.m_IIsolatedWindowsEnvironmentFile := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentFile;
         Retval.m_IIsolatedWindowsEnvironmentFile.all := m_ComRetVal;
      end return;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentShareFolderRequestOptions

   procedure Initialize (this : in out IsolatedWindowsEnvironmentShareFolderRequestOptions) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentShareFolderRequestOptions) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentShareFolderRequestOptions, IIsolatedWindowsEnvironmentShareFolderRequestOptions_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions /= null then
         if this.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Constructors for IsolatedWindowsEnvironmentShareFolderRequestOptions

   function Constructor return IsolatedWindowsEnvironmentShareFolderRequestOptions is
      Hr           : WinUI3.HResult := S_OK;
      tmp          : WinUI3.HResult := S_OK;
      m_hString    : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderRequestOptions");
      m_ComRetVal  : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderRequestOptions;
   begin
      return RetVal : IsolatedWindowsEnvironmentShareFolderRequestOptions do
         Hr := RoActivateInstance (m_hString, m_ComRetVal'Address);
         if Hr = S_OK then
            Retval.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentShareFolderRequestOptions;
            Retval.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions.all := m_ComRetVal;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end return;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentShareFolderRequestOptions

   function get_AllowWrite
   (
      this : in out IsolatedWindowsEnvironmentShareFolderRequestOptions
   )
   return WinUI3.Boolean is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Boolean;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions.all.get_AllowWrite (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_AllowWrite
   (
      this : in out IsolatedWindowsEnvironmentShareFolderRequestOptions;
      value : WinUI3.Boolean
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentShareFolderRequestOptions.all.put_AllowWrite (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentShareFolderResult

   procedure Initialize (this : in out IsolatedWindowsEnvironmentShareFolderResult) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentShareFolderResult) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentShareFolderResult, IIsolatedWindowsEnvironmentShareFolderResult_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentShareFolderResult /= null then
         if this.m_IIsolatedWindowsEnvironmentShareFolderResult.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentShareFolderResult.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentShareFolderResult);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentShareFolderResult

   function get_Status
   (
      this : in out IsolatedWindowsEnvironmentShareFolderResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderStatus is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentShareFolderStatus;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentShareFolderResult.all.get_Status (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_ExtendedError
   (
      this : in out IsolatedWindowsEnvironmentShareFolderResult
   )
   return WinUI3.Windows.Foundation.HResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.HResult;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentShareFolderResult.all.get_ExtendedError (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentStartProcessResult

   procedure Initialize (this : in out IsolatedWindowsEnvironmentStartProcessResult) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentStartProcessResult) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentStartProcessResult, IIsolatedWindowsEnvironmentStartProcessResult_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentStartProcessResult /= null then
         if this.m_IIsolatedWindowsEnvironmentStartProcessResult.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentStartProcessResult.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentStartProcessResult);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentStartProcessResult

   function get_Status
   (
      this : in out IsolatedWindowsEnvironmentStartProcessResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentStartProcessStatus is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentStartProcessStatus;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentStartProcessResult.all.get_Status (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_ExtendedError
   (
      this : in out IsolatedWindowsEnvironmentStartProcessResult
   )
   return WinUI3.Windows.Foundation.HResult is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Foundation.HResult;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentStartProcessResult.all.get_ExtendedError (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   function get_Process
   (
      this : in out IsolatedWindowsEnvironmentStartProcessResult
   )
   return WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentProcess'Class is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentProcess;
   begin
      return RetVal : WinUI3.Windows.Security.Isolation.IsolatedWindowsEnvironmentProcess do
         Hr := this.m_IIsolatedWindowsEnvironmentStartProcessResult.all.get_Process (m_ComRetVal'Access);
         if Hr /= S_OK then
            raise Program_Error;
         end if;
         Retval.m_IIsolatedWindowsEnvironmentProcess := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentProcess;
         Retval.m_IIsolatedWindowsEnvironmentProcess.all := m_ComRetVal;
      end return;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentTelemetryParameters

   procedure Initialize (this : in out IsolatedWindowsEnvironmentTelemetryParameters) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentTelemetryParameters) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentTelemetryParameters, IIsolatedWindowsEnvironmentTelemetryParameters_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentTelemetryParameters /= null then
         if this.m_IIsolatedWindowsEnvironmentTelemetryParameters.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentTelemetryParameters.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentTelemetryParameters);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Constructors for IsolatedWindowsEnvironmentTelemetryParameters

   function Constructor return IsolatedWindowsEnvironmentTelemetryParameters is
      Hr           : WinUI3.HResult := S_OK;
      tmp          : WinUI3.HResult := S_OK;
      m_hString    : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IIsolatedWindowsEnvironmentTelemetryParameters");
      m_ComRetVal  : aliased WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentTelemetryParameters;
   begin
      return RetVal : IsolatedWindowsEnvironmentTelemetryParameters do
         Hr := RoActivateInstance (m_hString, m_ComRetVal'Address);
         if Hr = S_OK then
            Retval.m_IIsolatedWindowsEnvironmentTelemetryParameters := new WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentTelemetryParameters;
            Retval.m_IIsolatedWindowsEnvironmentTelemetryParameters.all := m_ComRetVal;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end return;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentTelemetryParameters

   function get_CorrelationId
   (
      this : in out IsolatedWindowsEnvironmentTelemetryParameters
   )
   return WinUI3.Guid is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.Guid;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentTelemetryParameters.all.get_CorrelationId (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      return m_ComRetVal;
   end;

   procedure put_CorrelationId
   (
      this : in out IsolatedWindowsEnvironmentTelemetryParameters;
      value : WinUI3.Guid
   ) is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentTelemetryParameters.all.put_CorrelationId (value);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- RuntimeClass Initialization/Finalization for IsolatedWindowsEnvironmentUserInfo

   procedure Initialize (this : in out IsolatedWindowsEnvironmentUserInfo) is
   begin
      null;
   end;

   procedure Finalize (this : in out IsolatedWindowsEnvironmentUserInfo) is
      temp : WinUI3.UInt32 := 0;
      procedure Free is new Ada.Unchecked_Deallocation (IIsolatedWindowsEnvironmentUserInfo, IIsolatedWindowsEnvironmentUserInfo_Ptr);
   begin
      if this.m_IIsolatedWindowsEnvironmentUserInfo /= null then
         if this.m_IIsolatedWindowsEnvironmentUserInfo.all /= null then
            temp := this.m_IIsolatedWindowsEnvironmentUserInfo.all.Release;
            Free (this.m_IIsolatedWindowsEnvironmentUserInfo);
         end if;
      end if;
   end;

   -----------------------------------------------------------------------------
   -- Implemented Interfaces for IsolatedWindowsEnvironmentUserInfo

   function get_EnvironmentUserSid
   (
      this : in out IsolatedWindowsEnvironmentUserInfo
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentUserInfo.all.get_EnvironmentUserSid (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   function get_EnvironmentUserName
   (
      this : in out IsolatedWindowsEnvironmentUserInfo
   )
   return WinUI3.WString is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_ComRetVal      : aliased WinUI3.HString;
      AdaRetval        : WString;
   begin
      Hr := this.m_IIsolatedWindowsEnvironmentUserInfo.all.get_EnvironmentUserName (m_ComRetVal'Access);
      if Hr /= S_OK then
         raise Program_Error;
      end if;
      AdaRetval := To_Ada (m_ComRetVal);
      tmp := WindowsDeleteString (m_ComRetVal);
      return AdaRetVal;
   end;

   function TryWaitForSignInAsync
   (
      this : in out IsolatedWindowsEnvironmentUserInfo
   )
   return WinUI3.Boolean is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_Boolean.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_Boolean.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Boolean;
      m_IID            : aliased WinUI3.IID := (3451252659, 22408, 20637, (155, 225, 113, 204, 184, 163, 54, 42 )); -- Boolean;
      m_HandlerIID     : aliased WinUI3.IID := (3251884450, 44567, 23135, (181, 162, 189, 204, 136, 68, 136, 154 ));
      m_Handler        : AsyncOperationCompletedHandler_Boolean.Kind := new AsyncOperationCompletedHandler_Boolean.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_Boolean.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_Boolean.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_Boolean.Kind_Delegate, AsyncOperationCompletedHandler_Boolean.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

   begin
      Hr := this.m_IIsolatedWindowsEnvironmentUserInfo.all.TryWaitForSignInAsync (m_ComRetVal'Access);
      if Hr = S_OK then
         m_AsyncOperation := QI (m_ComRetVal);
         temp := m_ComRetVal.Release;
         if m_AsyncOperation /= null then
            Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
            while m_Captured = m_Compare loop
               m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
               m_Captured := m_Completed;
            end loop;
            if m_AsyncStatus = Completed_e then
               Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
            end if;
            temp := m_AsyncOperation.Release;
            temp := m_Handler.Release;
            if temp = 0 then
               Free (m_Handler);
            end if;
         end if;
      end if;
      return m_RetVal;
   end;

   function TryWaitForSignInWithProgressAsync
   (
      this : in out IsolatedWindowsEnvironmentUserInfo
   )
   return WinUI3.Boolean is
      Hr               : WinUI3.HResult := S_OK;
      tmp              : WinUI3.HResult := S_OK;
      m_Interface      : WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentUserInfo2 := null;
      temp             : WinUI3.UInt32 := 0;
      m_Temp           : WinUI3.Int32 := 0;
      m_Completed      : WinUI3.UInt32 := 0;
      m_Captured       : WinUI3.UInt32 := 0;
      m_Compare        : constant WinUI3.UInt32 := 0;

      use type IAsyncOperation_Boolean.Kind;

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus);

      m_AsyncOperation : aliased IAsyncOperation_Boolean.Kind;
      m_AsyncStatus    : aliased WinUI3.Windows.Foundation.AsyncStatus;
      m_ComRetVal      : aliased WinUI3.GenericObject := null;
      m_RetVal         : aliased WinUI3.Boolean;
      m_IID            : aliased WinUI3.IID := (859971916, 34217, 22313, (176, 241, 252, 102, 118, 64, 7, 138 )); -- Boolean;
      m_HandlerIID     : aliased WinUI3.IID := (3847394724, 54889, 22818, (191, 66, 187, 231, 234, 235, 69, 150 ));
      m_Handler        : AsyncOperationCompletedHandler_Boolean.Kind := new AsyncOperationCompletedHandler_Boolean.Kind_Delegate'(IAsyncOperation_Callback'Access, 1, m_HandlerIID'Unchecked_Access);

      function QI is new Generic_QueryInterface (GenericObject_Interface, IAsyncOperation_Boolean.Kind, m_IID'Unchecked_Access);
      function Convert is new Ada.Unchecked_Conversion (AsyncOperationCompletedHandler_Boolean.Kind, GenericObject);
      procedure Free is new Ada.Unchecked_Deallocation (AsyncOperationCompletedHandler_Boolean.Kind_Delegate, AsyncOperationCompletedHandler_Boolean.Kind);

      procedure IAsyncOperation_Callback (asyncInfo : WinUI3.GenericObject; asyncStatus: WinUI3.Windows.Foundation.AsyncStatus) is
         pragma unreferenced (asyncInfo);
      begin
         if asyncStatus = Completed_e then
            m_AsyncStatus := AsyncStatus;
         end if;
         m_Completed := 1;
         WakeByAddressSingle (m_Completed'Address);
      end;

      function QInterface is new Generic_QueryInterface (WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentUserInfo_Interface, WinUI3.Windows.Security.Isolation.IIsolatedWindowsEnvironmentUserInfo2, WinUI3.Windows.Security.Isolation.IID_IIsolatedWindowsEnvironmentUserInfo2'Unchecked_Access);
   begin
      m_Interface := QInterface (this.m_IIsolatedWindowsEnvironmentUserInfo.all);
      Hr := m_Interface.TryWaitForSignInWithProgressAsync (m_ComRetVal'Access);
      temp := m_Interface.Release;
      if Hr = S_OK then
         m_AsyncOperation := QI (m_ComRetVal);
         temp := m_ComRetVal.Release;
         if m_AsyncOperation /= null then
            Hr := m_AsyncOperation.Put_Completed (Convert (m_Handler));
            while m_Captured = m_Compare loop
               m_Temp := WaitOnAddress (m_Completed'Address, m_Compare'Address, 4, 4294967295);
               m_Captured := m_Completed;
            end loop;
            if m_AsyncStatus = Completed_e then
               Hr := m_AsyncOperation.GetResults (m_RetVal'Access);
            end if;
            temp := m_AsyncOperation.Release;
            temp := m_Handler.Release;
            if temp = 0 then
               Free (m_Handler);
            end if;
         end if;
      end if;
      return m_RetVal;
   end;

   -----------------------------------------------------------------------------
   -- Static RuntimeClass
   package body IsolatedWindowsHostMessenger is

      procedure RegisterHostMessageReceiver
      (
         receiverId : WinUI3.Guid;
         hostMessageReceivedCallback : WinUI3.Windows.Security.Isolation.HostMessageReceivedCallback
      ) is
         Hr               : WinUI3.HResult := S_OK;
         tmp              : WinUI3.HResult := S_OK;
         m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsHostMessenger");
         m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsHostMessengerStatics2_Interface'Class := null;
         temp             : WinUI3.UInt32 := 0;
      begin
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsHostMessengerStatics2'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.RegisterHostMessageReceiver (receiverId, hostMessageReceivedCallback);
            temp := m_Factory.Release;
            if Hr /= S_OK then
               raise Program_Error;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end;

      procedure UnregisterHostMessageReceiver
      (
         receiverId : WinUI3.Guid
      ) is
         Hr               : WinUI3.HResult := S_OK;
         tmp              : WinUI3.HResult := S_OK;
         m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsHostMessenger");
         m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsHostMessengerStatics2_Interface'Class := null;
         temp             : WinUI3.UInt32 := 0;
      begin
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsHostMessengerStatics2'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.UnregisterHostMessageReceiver (receiverId);
            temp := m_Factory.Release;
            if Hr /= S_OK then
               raise Program_Error;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end;

      procedure PostMessageToReceiver
      (
         receiverId : WinUI3.Guid;
         message : GenericObject
      ) is
         Hr               : WinUI3.HResult := S_OK;
         tmp              : WinUI3.HResult := S_OK;
         m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsHostMessenger");
         m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsHostMessengerStatics_Interface'Class := null;
         temp             : WinUI3.UInt32 := 0;
      begin
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsHostMessengerStatics'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.PostMessageToReceiver (receiverId, message);
            temp := m_Factory.Release;
            if Hr /= S_OK then
               raise Program_Error;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
      end;

      function GetFileId
      (
         filePath : WinUI3.WString
      )
      return WinUI3.Guid is
         Hr               : WinUI3.HResult := S_OK;
         tmp              : WinUI3.HResult := S_OK;
         m_hString        : constant WinUI3.HString := To_HString ("Windows.Security.Isolation.IsolatedWindowsHostMessenger");
         m_Factory        : access WinUI3.Windows.Security.Isolation.IIsolatedWindowsHostMessengerStatics_Interface'Class := null;
         temp             : WinUI3.UInt32 := 0;
         m_ComRetVal      : aliased WinUI3.Guid;
         HStr_filePath : constant WinUI3.HString := To_HString (filePath);
      begin
         Hr := RoGetActivationFactory (m_hString, IID_IIsolatedWindowsHostMessengerStatics'Access , m_Factory'Address);
         if Hr = S_OK then
            Hr := m_Factory.GetFileId (HStr_filePath, m_ComRetVal'Access);
            temp := m_Factory.Release;
            if Hr /= S_OK then
               raise Program_Error;
            end if;
         end if;
         tmp := WindowsDeleteString (m_hString);
         tmp := WindowsDeleteString (HStr_filePath);
         return m_ComRetVal;
      end;

   end IsolatedWindowsHostMessenger;

   -----------------------------------------------------------------------------
   -- Delegate MessageReceivedCallback

   function Invoke
   (
      this : access MessageReceivedCallback_Delegate;
      receiverId : WinUI3.Guid;
      message : GenericObject
   )
   return WinUI3.Hresult is
      Hr : constant WinUI3.HResult := S_OK;
   begin
      this.Callback (receiverId, message);
      return Hr;
   end;

end WinUI3.Windows.Security.Isolation;
